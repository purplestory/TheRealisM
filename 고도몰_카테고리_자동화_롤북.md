# 고도몰 카테고리 자동화 롤북

## 1. 카테고리 트리 구조 및 주요 HTML

- **대분류/중분류/소분류 노드**
  - `<li id="카테고리코드" rel="node" ...><a ...>카테고리명</a></li>`
  - 대분류: `li[rel='root'] > a`
  - 중/소분류: `li[rel='node'] > a`
- **"새 카테고리" 노드**
  - `<a ...>새 카테고리</a>`
- **jsTree 노드 상태**
  - `class="leaf"`: 하위 카테고리가 없는 노드 (ul 태그가 없음)
  - `class="closed"`: 하위 카테고리가 있지만 닫혀있는 노드 (ul 태그가 있지만 숨겨져 있음)
  - `class="open"`: 하위 카테고리가 열려있는 노드 (ul 태그가 보이는 상태)

## 2. 주요 버튼/입력창 선택자

- **저장 버튼**
  - `input[type='submit'][value='저장'].btn.save`
- **하위 카테고리 생성 버튼**
  - `input[type='button'][value='하위 카테고리 생성']`
- **카테고리명 입력**
  - `input[name='cateNm']`
- **"새 카테고리" 노드**
  - `a[text()='새 카테고리']`

## 3. 자동화 작업 순서(중분류/소분류 생성 기준)

1. **부모 노드 클릭**
   - 트리에서 해당 부모 노드를 클릭하여 포커스 이동
2. **하위 카테고리 생성 버튼 클릭**
   - `input[type='button'][value='하위 카테고리 생성']` 클릭
3. **저장 버튼 클릭**
   - `input[type='submit'][value='저장'].btn.save` 클릭
4. **부모 노드 더블클릭**
   - 화면 갱신 후 부모 노드를 더블클릭하여 트리 열기
5. **"새 카테고리" 노드 생성 대기 및 클릭**
   - `a[text()='새 카테고리']` 노드가 생성될 때까지 대기 후 클릭
6. **카테고리명 입력**
   - `input[name='cateNm']`에 새 이름 입력
7. **저장 버튼 클릭**
   - `input[type='submit'][value='저장'].btn.save` 클릭

## 4. 예외/오류 처리 규칙

- **stale element 오류**
  - 부모 노드/버튼을 매번 새로 탐색하여 클릭
  - 각 단계마다 충분히 대기(1~2초)
- **"새 카테고리"가 남아있을 때**
  - 저장 또는 삭제 후 다음 단계 진행
- **Alert(알림창) 발생 시**
  - 자동으로 `accept()` 처리(필요시)
- **저장 버튼이 비활성화일 때**
  - 입력 후 blur 처리 및 활성화될 때까지 반복 체크 후 클릭
- **jsTree 노드 상태 처리**
  - leaf 노드: 하위 카테고리 생성 불가능
  - closed 노드: 노드 클릭 또는 jQuery tree API로 열기 시도
  - ul 태그가 없는 경우: leaf 노드로 간주

## 5. 수동 개입 포인트

- 자동화가 "새 카테고리" 이름 입력 후 저장 버튼을 누르지 않으면, 직접 저장 버튼 클릭 가능
- 트리 구조가 꼬이거나 stale 오류가 반복되면, 트리 새로고침 후 재시도
- Alert(삭제 등) 발생 시 직접 확인 및 처리
- 노드가 leaf 상태로 잘못 인식될 경우, 수동으로 노드 클릭하여 상태 갱신

## 6. 기타 참고 사항

- 자동화 스크립트는 반드시 실제 HTML 구조와 선택자에 맞춰 동작해야 함
- 관리자 페이지 구조가 변경되면 롤북도 반드시 갱신
- 자동화 실패 시, 수동 조작 방법을 숙지할 것
- jsTree의 노드 상태(leaf/closed/open)를 정확히 파악하여 처리할 것 